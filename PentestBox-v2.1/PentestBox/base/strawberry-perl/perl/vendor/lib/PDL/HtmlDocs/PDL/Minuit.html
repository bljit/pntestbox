<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a>
    <ul>
      <li><a href="#mninit">mninit</a></li>
      <li><a href="#mn_abre">mn_abre</a></li>
      <li><a href="#mn_cierra">mn_cierra</a></li>
      <li><a href="#mnparm">mnparm</a></li>
      <li><a href="#mnexcm">mnexcm</a></li>
      <li><a href="#mnpout">mnpout</a></li>
      <li><a href="#mnstat">mnstat</a></li>
      <li><a href="#mnemat">mnemat</a></li>
      <li><a href="#mnerrs">mnerrs</a></li>
      <li><a href="#mncont">mncont</a></li>
      <li><a href="#mn_init">mn_init()</a></li>
      <li><a href="#mn_def_pars">mn_def_pars()</a></li>
      <li><a href="#mn_excm">mn_excm()</a></li>
      <li><a href="#mn_pout">mn_pout()</a></li>
      <li><a href="#mn_stat">mn_stat()</a></li>
      <li><a href="#mn_emat">mn_emat()</a></li>
      <li><a href="#mn_err">mn_err()</a></li>
      <li><a href="#mn_contour">mn_contour()</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>PDL::Minuit -- a PDL interface to the Minuit library</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This package implements an interface to the Minuit minimization routines (part of the CERN Library)</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<p>A basic fit with Minuit will call three functions in this package. First, a basic initialization is done with mn_init(). Then, the parameters are defined via the function mn_def_pars(), which allows to set upper and lower bounds. Then the function mn_excm() can be used to issue many Minuit commands, including simplex and migrad minimization algorithms (see Minuit manual for more details).</p>

<p>See the test file minuit.t in the test (t/) directory for a basic example.</p>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<h2 id="mninit">mninit</h2>

<pre><code>  Signature: (int a();int b(); int c())</code></pre>

<p>info not available</p>

<p>mninit does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mn_abre">mn_abre</h2>

<pre><code>  Signature: (int l(); char* nombre; char* mode)</code></pre>

<p>info not available</p>

<p>mn_abre does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mn_cierra">mn_cierra</h2>

<pre><code>  Signature: (int l())</code></pre>

<p>info not available</p>

<p>mn_cierra does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mnparm">mnparm</h2>

<pre><code>  Signature: (int a(); double b(); double c(); double d(); double e(); int [o] ia(); char* str)</code></pre>

<p>info not available</p>

<p>mnparm does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mnexcm">mnexcm</h2>

<pre><code>  Signature: (double a(n); int ia(); int [o] ib(); char* str; SV* funcion; int numelem)</code></pre>

<p>info not available</p>

<p>mnexcm does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mnpout">mnpout</h2>

<pre><code>  Signature: (int ia(); double [o] a(); double [o] b(); double [o] c(); double [o] d();int [o] ib(); SV* str)</code></pre>

<p>info not available</p>

<p>mnpout does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mnstat">mnstat</h2>

<pre><code>  Signature: (double [o] a(); double [o] b(); double [o] c(); int [o] ia(); int [o] ib(); int [o] ic())</code></pre>

<p>info not available</p>

<p>mnstat does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mnemat">mnemat</h2>

<pre><code>  Signature: (double [o] mat(n,n))</code></pre>

<p>info not available</p>

<p>mnemat does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mnerrs">mnerrs</h2>

<pre><code>  Signature: (int ia(); double [o] a(); double [o] b(); double [o] c(); double [o] d())</code></pre>

<p>info not available</p>

<p>mnerrs does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mncont">mncont</h2>

<pre><code>  Signature: (int ia(); int ib(); int ic(); double [o] a(n); double [o] b(n); int [o] id(); SV* funcion; int numelem)</code></pre>

<p>info not available</p>

<p>mncont does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2 id="mn_init">mn_init()</h2>

<p>The function mn_init() does the basic initialization of the fit. The first argument has to be a reference to the function to be minimized. The function to be minimized has to receive five arguments ($npar,$grad,$fval,$xval,$iflag). The first is the number of parameters currently variable. The second is the gradient of the function (which is not necessarily used, see the Minuit documentation). The third is the current value of the function. The fourth is a piddle with the values of the parameters. The fifth is an integer flag, which indicates what the function is supposed to calculate. The function has to return the values ($fval,$grad), the function value and the function gradient.</p>

<p>There are three optional arguments to mn_init(). By default, the output of Minuit will come through STDOUT unless a filename $logfile is given in the Log option. Note that this will mercilessly erase $logfile if it already exists. Aditionally, a title can be given to the fit by the Title option, the default is &#39;Minuit Fit&#39;. If the output is written to a logfile, this is assigned Fortran unit number 88. If for whatever reason you want to have control over the unit number that Fortran associates to the logfile, you can pass the number through the Unit option.</p>

<p>Usage:</p>

<pre><code> mn_init($function_ref,{Log=&gt;$logfile,Title=&gt;$title,Unit=&gt;$unit})</code></pre>

<p>Example:</p>

<pre><code> mn_init(\&amp;my_function);

 #same as above but outputting to a file &#39;log.out&#39;.
 #title for fit is &#39;My fit&#39;
 mn_init(\&amp;my_function,
         {Log =&gt; &#39;log.out&#39;, Title =&gt; &#39;My fit&#39;});


 sub my_function{
    # the five variables input to the function to be minimized
    # xval is a piddle containing the current values of the parameters
    my ($npar,$grad,$fval,$xval,$iflag) = @_;


    # Here is code computing the value of the function
    # and potentially also its gradient
    # ......

    # return the two variables. If no gradient is being computed
    # just return the $grad that came as input
    return ($fval, $grad);
 }</code></pre>

<h2 id="mn_def_pars">mn_def_pars()</h2>

<p>The function mn_def_pars() defines the initial values of the parameters of the function to be minimized and the value of the initial steps around these values that the minimizer will use for the first variations of the parameters in the search for the minimum. There are several optional arguments. One allows to assign names to these parameters which otherwise get names (Par_0, Par_1,....,Par_n) by default. Another two arguments can give lower and upper bounds for the parameters via two piddles. If the lower and upper bound for a given parameter are both equal to 0 then the parameter is unbound. By default these lower and upper bound piddles are set to zeroes(n), where n is the number of parameters, i.e. the parameters are unbound by default.</p>

<p>The function needs two input variables: a piddle giving the initial values of the parameters and another piddle giving the initial steps. An optional reference to a perl array with the variable names can be passed, as well as piddles with upper and lower bounds for the parameters (see example below).</p>

<p>It returns an integer variable which is 0 upon success.</p>

<p>Usage:</p>

<pre><code> $iflag = mn_def_pars($pars, $steps,{Names =&gt; \@names, 
                        Lower_bounds =&gt; $lbounds,
                        Upper_bounds =&gt; $ubounds})</code></pre>

<p>Example:</p>

<pre><code> #initial parameter values
 my $pars = pdl(2.5,3.0);          

 #steps
 my $steps = pdl(0.3,0.5);     

 #parameter names    
 my @names = (&#39;intercept&#39;,&#39;slope&#39;);

 #use mn_def_pars with default parameter names (Par_0,Par_1,...)
 my $iflag = mn_def_pars($pars,$steps);

 #use of mn_def_pars explictly specify parameter names
 $iflag = mn_def_pars($pars,$steps,{Names =&gt; \@names});

 # specify lower and upper bounds for the parameters. 
 # The example below leaves parameter 1 (intercept) unconstrained
 # and constrains parameter 2 (slope) to be betwen 0 and 100
 my $lbounds = pdl(0, 0);
 my $ubounds = pdl(0, 100);

 $iflag = mn_def_pars($pars,$steps,{Names =&gt; \@names, 
                        Lower_bounds =&gt; $lbounds,
                        Upper_bounds =&gt; $ubounds}});

 #same as above because $lbounds is by default zeroes(n)
 $iflag = mn_def_pars($pars,$steps,{Names =&gt; \@names, 
                        Upper_bounds =&gt; $ubounds}});</code></pre>

<h2 id="mn_excm">mn_excm()</h2>

<p>The function mn_excm() executes a Minuit command passed as a string. The first argument is the command string and an optional second argument is a piddle with arguments to the command. The available commands are listed in Chapter 4 of the Minuit manual (see url below).</p>

<p>It returns an integer variable which is 0 upon success.</p>

<p>Usage:</p>

<pre><code> $iflag = mn_excm($command_string, {$arglis})</code></pre>

<p>Example:</p>

<pre><code>  #start a simplex minimization
  my $iflag = mn_excm(&#39;simplex&#39;);

  #same as above but specify the maximum allowed numbers of
  #function calls in the minimization 
  my $arglist = pdl(1000);
  $iflag = mn_excm(&#39;simplex&#39;,$arglist);

  #start a migrad minimization
  $iflag = mn_excm(&#39;migrad&#39;)

  #set Minuit strategy in order to get the most reliable results
  $arglist = pdl(2)
  $iflag = mn_excm(&#39;set strategy&#39;,$arglist);

  # each command can be specified by a minimal string that uniquely
  # identifies it (see Chapter 4 of Minuit manual). The comannd above
  # is equivalent to:
  $iflag = mn_excm(&#39;set stra&#39;,$arglis);</code></pre>

<h2 id="mn_pout">mn_pout()</h2>

<p>The function mn_pout() gets the current value of a parameter. It takes as input the parameter number and returns an array with the parameter value, the current estimate of its uncertainty (0 if parameter is constant), lower bound on the parameter, if any (otherwise 0), upper bound on the parameter, if any (otherwise 0), integer flag (which is equal to the parameter number if variable, zero if the parameter is constant and negative if parameter is not defined) and the parameter name.</p>

<p>Usage:</p>

<pre><code>     ($val,$err,$bnd1,$bnd2,$ivarbl,$par_name) = mn_pout($par_number);</code></pre>

<h2 id="mn_stat">mn_stat()</h2>

<p>The function mn_stat() gets the current status of the minimization. It returns an array with the best function value found so far, the estimated vertical distance remaining to minimum, the value of UP defining parameter uncertainties (default is 1), the number of currently variable parameters, the highest parameter defined and an integer flag indicating how good the covariance matrix is (0=not calculated at all; 1=diagonal approximation, not accurate; 2=full matrix, but forced positive definite; 3=full accurate matrix)</p>

<p>Usage:</p>

<pre><code>    ($fmin,$fedm,$errdef,$npari,$nparx,$istat) = mn_stat();</code></pre>

<h2 id="mn_emat">mn_emat()</h2>

<p>The function mn_emat returns the covariance matrix as a piddle.</p>

<p>Usage:</p>

<pre><code>  $emat = mn_emat();</code></pre>

<h2 id="mn_err">mn_err()</h2>

<p>The function mn_err() returns the current existing values for the error in the fitted parameters. It returns an array with the positive error, the negative error, the &quot;parabolic&quot; parameter error from the error matrix and the global correlation coefficient, which is a number between 0 and 1 which gives the correlation between the requested parameter and that linear combination of all other parameters which is most strongly correlated with it. Unless the command &#39;MINOS&#39; has been issued via the function mn_excm(), the first three values will be equal.</p>

<p>Usage:</p>

<pre><code>  ($eplus,$eminus,$eparab,$globcc) = mn_err($par_number);</code></pre>

<h2 id="mn_contour">mn_contour()</h2>

<p>The function mn_contour() finds contours of the function being minimized with respect to two chosen parameters. The contour level is given by F_min + UP, where F_min is the minimum of the function and UP is the ERRordef specfied by the user, or 1.0 by default (see Minuit manual). The contour calculated by this function is dynamic, in the sense that it represents the minimum of the funcion being minimized with respect to all the other NPAR-2 parameters (if any).</p>

<p>The function takes as input the parameter numbers with respect to which the contour is to be determined (two) and the number of points $npt required on the contour (&gt;4). It returns an array with piddles $xpt,$ypt containing the coordinates of the contour and a variable $nfound indicating the number of points actually found in the contour. If all goes well $nfound will be equal to $npt, but it can be negative if the input arguments are not valid, zero if less than four points have been found or &lt;$npt if the program could not find $npt points.</p>

<p>Usage:</p>

<pre><code>  ($xpt,$ypt,$nfound) = mn_contour($par_number_1,$par_number_2,$npt)</code></pre>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="../.\PDL.html">PDL</a></p>

<p>The Minuit documentation is online at</p>

<pre><code>  http://wwwasdoc.web.cern.ch/wwwasdoc/minuit/minmain.html</code></pre>

<h1 id="AUTHOR">AUTHOR</h1>

<p>This file copyright (C) 2007 Andres Jordan &lt;ajordan@eso.org&gt;. All rights reserved. There is no warranty. You are allowed to redistribute this software/documentation under certain conditions. For details, see the file COPYING in the PDL distribution. If this file is separated from the PDL distribution, the copyright notice should be included in the file.</p>


</body>

</html>


