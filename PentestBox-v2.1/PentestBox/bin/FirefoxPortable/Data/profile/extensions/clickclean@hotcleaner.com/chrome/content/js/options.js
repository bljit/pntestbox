// MIT, Extension for Firefox 4+ Browser - Click&Clean - HOTCLEANER.COM - Vlad and Serge Strukoff

// ==ClosureCompiler==
// @compilation_level SIMPLE_OPTIMIZATIONS

addEventListener("load",function(){function l(){a("san-enabled").checked||a("san-close").checked?(a("san-ask").disabled=a("san-clear").disabled=!1,a("san-time").disabled=!a("san-ask").checked):a("san-time").disabled=a("san-ask").disabled=a("san-clear").disabled=!0}function m(){a("ext-sanitize").checked||a("ext-close").checked?a("ext-path").disabled=a("ext-browse").disabled=a("ext-arg").disabled=a("ext-run").disabled=!1:a("ext-path").disabled=a("ext-browse").disabled=a("ext-arg").disabled=a("ext-run").disabled=
!0}function q(d){var c;c=d?Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getDefaultBranch("extensions.clickclean."):Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getBranch("extensions.clickclean.");a("san-enabled").checked=c.getBoolPref("sanitize");a("san-close").checked=c.getBoolPref("close");a("san-ask").checked=c.getBoolPref("showPrompt");a("san-time").selectedIndex=c.getIntPref("wait");
l();a("ext-sanitize").checked=c.getBoolPref("useExt");a("ext-close").checked=c.getBoolPref("closeExt");d=a("ext-path").value=c.getComplexValue("path",Components.interfaces.nsISupportsString).data;a("ext-arg").value=c.getComplexValue("arg",Components.interfaces.nsISupportsString).data;m();a("adv-lso").checked=c.getBoolPref("lso");a("adv-tabs").checked=c.getBoolPref("tabs");a("adv-tab").checked=c.getBoolPref("tab");a("adv-tab").disabled=!a("adv-tabs").checked;if(1>d.length&&"Win32"==navigator.platform){try{c=
0;var e=Components.classes["@mozilla.org/windows-registry-key;1"].createInstance(Components.interfaces.nsIWindowsRegKey);e.open(e.ROOT_KEY_LOCAL_MACHINE,"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\CCleaner",window.navigator.oscpu.indexOf("64")?e.ACCESS_QUERY_VALUE|e.WOW64_64:e.ACCESS_QUERY_VALUE);e.hasValue("DisplayIcon")?c=e.readStringValue("DisplayIcon"):e.hasValue("InstallLocation")&&(c=e.readStringValue("InstallLocation")+"\\CCleaner.exe");e.close();d=c}catch(b){d=0}d&&(a("ext-path").value=
d,a("ext-arg").value="/auto")}}function g(a){var c=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow("navigator:browser").gBrowser;c.selectedTab=c.addTab(a)}function n(a){function c(){b&&e.clearTimeout(b)}var e=Components.classes["@mozilla.org/embedcomp/window-watcher;1"].getService(Components.interfaces.nsIWindowWatcher).openWindow(null,"chrome://browser/content/sanitize.xul",null,"chrome,centerscreen",null),b=0;
e.addEventListener("load",function(){function f(){k.label=g+" ("+j+")";1>j?h.acceptDialog():(--j,b=e.setTimeout(f,1E3))}var h=e.document.getElementsByTagName("prefwindow")[0],k,j;e.addEventListener("unload",c,!1);if(!(7<a))if(1>a)h.acceptDialog();else if(k=h.getButton("accept")){j=a;var g=k.label;f()}},!1)}function r(){function d(){try{b.initWithPath(f),b.exists&&b.remove(!0)}catch(a){}}if(a("adv-lso").checked){var c=Components.classes["@mozilla.org/xre/app-info;1"].getService(Components.interfaces.nsIXULRuntime).OS.toLowerCase(),
e=Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties),b=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile),f;"linux"==c?(c=e.get("Home",Components.interfaces.nsIFile),f=c.path+"/.macromedia/Flash_Player/#SharedObjects",d(),f=c.path+"/.macromedia/Flash_Player/macromedia.com/support/flashplayer/sys"):"darwin"==c?(c=e.get("ULibDir",Components.interfaces.nsIFile),f=c.path+"/Preferences/Macromedia/Flash Player/#SharedObjects",
d(),f=c.path+"/Preferences/Macromedia/Flash Player/macromedia.com/support/flashplayer/sys"):(c=e.get("AppData",Components.interfaces.nsIFile),f=c.path+"\\Macromedia\\Flash Player\\#SharedObjects",d(),f=c.path+"\\Macromedia\\Flash Player\\macromedia.com\\support\\flashplayer\\sys");d()}}function s(d){if(a("adv-tabs").checked){var c=a("adv-tab").checked,b=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator),g=b.getMostRecentWindow("navigator:browser"),
b=b.getEnumerator(""),f;if(b)for(;b.hasMoreElements();)if(f=b.getNext(),f==g){var h=f.gBrowser,k=h.tabContainer;c||(h.selectedTab=h.addTab("about:blank"));f=k.childNodes;for(var j=0,l=f.length-1;j<l;j++)h.removeTab(f[0].selected?f[1]:f[0]),f=k.childNodes}else f.close()}d?a("san-ask").checked?n(a("san-time").selectedIndex):n(0):(d=a("ext-path").value,c=a("ext-arg").value,d&&(g=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile),b=Components.classes["@mozilla.org/process/util;1"].createInstance(Components.interfaces.nsIProcess),
g.initWithPath(d),b.init(g),b.run(!1,[c],1)))}function a(a){return document.getElementById(a)}var p=!0;innerWidth=a("page").clientWidth;innerHeight=a("page").clientHeight;var b=a("bundle_clickclean");b&&(document.title=b.getString("doctitle"),a("home-text").textContent=b.getString("home-text"),a("fb-text").textContent=b.getString("fb-text"),a("tw-text").textContent=b.getString("tw-text"),a("contact-text").textContent=b.getString("contact-text"),a("san-cap").textContent=b.getString("san-cap"),a("san-enabled-desc").textContent=
b.getString("san-enabled-desc"),a("san-close-desc").textContent=b.getString("san-close-desc"),a("san-ask-desc").textContent=b.getString("san-ask-desc"),a("san-time-desc").textContent=b.getString("san-time-desc"),a("san-time-inf").textContent=b.getString("san-time-inf"),a("san-clear").textContent=b.getString("san-clear"),a("ext-cap").textContent=b.getString("ext-cap"),a("ext-sanitize-desc").textContent=b.getString("ext-sanitize-desc"),a("ext-close-desc").textContent=b.getString("ext-close-desc"),a("ext-path-desc").textContent=
b.getString("ext-path-desc"),a("ext-arg-desc").textContent=b.getString("ext-arg-desc"),a("ext-run").textContent=b.getString("ext-run"),a("adv-cap").textContent=b.getString("adv-cap"),a("adv-lso-desc").textContent=b.getString("adv-lso-desc"),a("adv-tabs-desc").textContent=b.getString("adv-tabs-desc"),a("adv-tab-desc").textContent=b.getString("adv-tab-desc"),a("opt-def").textContent=b.getString("opt-def"),a("opt-ok").textContent=b.getString("opt-ok"),a("opt-cancel").textContent=b.getString("opt-cancel"));
q();addEventListener("unload",function(){if(p&&p){var d=Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getBranch("extensions.clickclean.");d.setBoolPref("sanitize",a("san-enabled").checked);d.setBoolPref("close",a("san-close").checked);d.setBoolPref("showPrompt",a("san-ask").checked);d.setIntPref("wait",a("san-time").selectedIndex);d.setBoolPref("useExt",a("ext-sanitize").checked);d.setBoolPref("closeExt",a("ext-close").checked);var c=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
c.data=a("ext-path").value;d.setComplexValue("path",Components.interfaces.nsISupportsString,c);c.data=a("ext-arg").value;d.setComplexValue("arg",Components.interfaces.nsISupportsString,c);d.setBoolPref("lso",a("adv-lso").checked);d.setBoolPref("tabs",a("adv-tabs").checked);d.setBoolPref("tab",a("adv-tab").checked)}},!1);a("home").addEventListener("click",function(a){g("http://www.hotcleaner.com/clickclean_firefox.html");a.preventDefault()},!1);a("fb").addEventListener("click",function(a){g("http://www.facebook.com/clickclean");
a.preventDefault()},!1);a("tw").addEventListener("click",function(a){g("http://twitter.com/clickclean");a.preventDefault()},!1);a("contact").addEventListener("click",function(a){g("http://www.hotcleaner.com/security-and-privacy-software-feedback.html");a.preventDefault()},!1);a("san-cap").addEventListener("click",function(){n(8)},!1);a("san-enabled").addEventListener("click",l,!1);a("san-close").addEventListener("click",l,!1);a("san-ask").addEventListener("click",function(){a("san-time").disabled=
!this.checked},!1);a("san-clear").addEventListener("click",function(){a("adv-lso").checked&&r();s(1)},!1);a("ext-sanitize").addEventListener("click",m,!1);a("ext-close").addEventListener("click",m,!1);a("ext-browse").addEventListener("click",function(){var b;b=Components.classes["@mozilla.org/filepicker;1"].createInstance(Components.interfaces.nsIFilePicker);var c=Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties),e=Components.classes["@mozilla.org/xre/app-info;1"].getService(Components.interfaces.nsIXULRuntime).OS.toLowerCase();
b.init(window,"Choose application",0);"linux"==e?b.displayDirectory=c.get("Desk",Components.interfaces.nsIFile):"darwin"!=e&&(b.appendFilter("Windows executable","*.exe"),b.appendFilter("Batch file","*.bat"),b.appendFilter("All","*.*"),b.displayDirectory=c.get("Desk",Components.interfaces.nsIFile));c=b.show();b=0==c||2==c?b.file.path:void 0;b&&(a("ext-path").value=b)},!1);a("ext-run").addEventListener("click",function(){a("adv-lso").checked&&r();s()},!1);a("adv-tabs").addEventListener("click",function(){a("adv-tab").disabled=
!this.checked},!1);a("opt-def").addEventListener("click",function(){q(1)},!1);a("opt-ok").addEventListener("click",function(){close()},!1);a("opt-cancel").addEventListener("click",function(){p=!1;close()},!1)},!1);